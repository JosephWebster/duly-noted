{"name":"./ts/index.ts","lines":[{"number":0,"longComment":true,"comment":""},{"number":1,"longComment":true,"comment":"# !Index"},{"number":2,"longComment":true,"comment":"@authors/chris"},{"number":3,"longComment":true,"comment":" * "},{"number":4,"longComment":true,"comment":"This is file runs Duly Noted"},{"number":5,"comment":""},{"number":6,"code":"import {IConfig} from \"./classes/IConfig\";"},{"number":7,"code":"import {ReferenceParser} from \"./modules/referenceParser\";"},{"number":8,"code":"import parseArgs = require(\"minimist\");"},{"number":9,"code":"import _ = require(\"underscore\");"},{"number":10,"code":"import * as path from \"path\";"},{"number":11,"code":"import glob = require(\"glob\");"},{"number":12,"code":"import Q = require(\"q\");"},{"number":13,"code":"import {MarkdownGenerator} from \"./generators/markdownGenerator\";"},{"number":14,"code":"import {HtmlGenerator} from \"./generators/Htmlgenerator\";"},{"number":15,"code":"import log4js = require(\"log4js\");"},{"number":16,"code":"let logger = log4js.getLogger(\"duly-noted::run\");"},{"number":17,"code":""},{"number":18,"code":"export function run () {"},{"number":19,"code":"    logger.info(\"Welcome to Duly Noted.\");"},{"number":20,"code":"    let args = parseArgs(process.argv.slice(2));"},{"number":21,"code":"    let config: IConfig;"},{"number":22,"code":""},{"number":23,"comment":" Parse config file","code":"   "},{"number":24,"code":"     if (args[\"c\"]) {"},{"number":25,"code":"        config = require(args[\"c\"]);"},{"number":26,"code":"     } else {"},{"number":27,"code":"        config = require(process.cwd() + \"/duly-noted.json\");"},{"number":28,"code":"     }"},{"number":29,"code":""},{"number":30,"code":"     let getFiles: Q.IPromise<string[]>[] = [];"},{"number":31,"code":""},{"number":32,"code":"     for (let i = 0; i < config.files.length; i++) {"},{"number":33,"code":"        getFiles.push(getFilesFromGlob(config.files[i]));"},{"number":34,"code":"     }"},{"number":35,"code":""},{"number":36,"code":"     Q.all(getFiles)"},{"number":37,"code":"     .then((results) => {"},{"number":38,"code":"         let files = _.flatten(results);"},{"number":39,"code":"         let referenceParser = new ReferenceParser(files,"},{"number":40,"code":"                                                   new RegExp(config.commentRegExp),"},{"number":41,"code":"                                                   new RegExp(config.anchorRegExp),"},{"number":42,"code":"                                                   new RegExp(config.longCommentOpenRegExp),"},{"number":43,"code":"                                                   new RegExp(config.longCommentLineRegExp),"},{"number":44,"code":"                                                   new RegExp(config.longCommentCloseRegExp),"},{"number":45,"code":"                                                   config.outputDir);"},{"number":46,"code":"         referenceParser.parse()"},{"number":47,"code":"         .then((response) => {"},{"number":48,"code":"             logger.info(\"parsing complete, beginning export of HTML\");"},{"number":49,"code":"             new HtmlGenerator(config.outputDir, path.join(__dirname, \"templates\", \"stacked.html\"), new RegExp(config.anchorRegExp), new RegExp(config.linkRegExp)).generate();"},{"number":50,"comment":"new MarkdownGenerator(config.outputDir).generate();","code":"            "},{"number":51,"code":"         })"},{"number":52,"code":"         .catch( (err: Error) => {"},{"number":53,"code":"             logger.error(err.message + err.stack);"},{"number":54,"code":"         });"},{"number":55,"code":"     });"},{"number":56,"code":"}"},{"number":57,"code":""},{"number":58,"code":"function getFilesFromGlob(globString: string): Q.Promise<string[]> {"},{"number":59,"code":"    return Q.Promise<string[]>((resolve, reject) => {"},{"number":60,"code":"        glob(globString, (err, files: string[]) => {"},{"number":61,"code":"            if (err) reject(err);"},{"number":62,"code":"            resolve(files);"},{"number":63,"code":"        });"},{"number":64,"code":"    });"},{"number":65,"code":"}"}],"type":"typescript"}